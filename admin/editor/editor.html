<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor.js with Auto-Sorting & Default Content</title>

    <!-- Editor.js and Plugins -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/paragraph@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/underline@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/image@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/inline-code@latest"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f4f4;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            width: 60%;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        }
        .subheading-container {
            display: flex;
            flex-direction: column;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
            margin-bottom: 10px;
        }
        .subheading-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #ddd;
            padding: 5px;
            border-radius: 5px;
        }
        .editor-box {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ccc;
            background: #fff;
            margin-top: 5px;
        }
        .remove-btn, .clear-btn, .add-btn {
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .remove-btn { background: red; color: white; }
        .clear-btn { background: orange; color: white; }
        .add-btn { background: green; color: white; }
        .number-input {
            width: 50px;
            text-align: center;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Editor.js with Auto-Sorting & Default Content</h1>
        <button onclick="clearAllData()">Clear All Data</button>
        <div id="main-editor"></div>
    </div>

    <script>
        const defaultSubheadings = [
            { title: "Name", number: 11 },
            { title: "Age", number: 12 },
            { title: "Address", number: 13 }
        ];

        let subheadings = JSON.parse(localStorage.getItem('subheadings')) || [...defaultSubheadings];
        let innerEditors = {};

        function getDefaultContent(title) {
            return {
                blocks: [
                    { type: "header", data: { text: title, level: 2 } },
                    { type: "header", data: { text: "Subheading Example", level: 3 } },
                    { type: "paragraph", data: { text: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla facilisi. Fusce ac purus id odio consectetur scelerisque. Duis in quam eu metus bibendum ultrices. Etiam nec ultricies eros. Donec posuere leo nec tellus cursus, at ultrices est scelerisque." } },
                    { 
                        type: "table", 
                        data: { content: [
                            ["Header 1", "Header 2", "Header 3"],
                            ["Row 1 Col 1", "Row 1 Col 2", "Row 1 Col 3"],
                            ["Row 2 Col 1", "Row 2 Col 2", "Row 2 Col 3"]
                        ]}
                    }
                ]
            };
        }

        function createSubheadingBlock(subheading, index) {
            return `
                <div class="subheading-container" id="subheading-${index}">
                    <div class="subheading-header">
                        <div>
                            <input type="checkbox">
                            <input type="number" class="number-input" value="${subheading.number}" onchange="updateNumber(${index}, this.value)">
                            ${subheading.title}
                        </div>
                        <div>
                            <button class="add-btn" onclick="addSubheading(${index})">‚ûï</button>
                            <button class="remove-btn" onclick="removeSubheading(${index})">‚ùå</button>
                            <button class="clear-btn" onclick="clearEditor(${index})">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div id="editor-${index}" class="editor-box"></div>
                </div>`;
        }

        function updateNumber(index, newNumber) {
            subheadings[index].number = parseInt(newNumber, 10);
            sortSubheadings();
            renderSubheadings();
        }

        function sortSubheadings() {
            subheadings.sort((a, b) => a.number - b.number);
            saveSubheadings();
        }

        function renderSubheadings() {
            sortSubheadings();
            let mainEditorContainer = document.getElementById("main-editor");
            mainEditorContainer.innerHTML = subheadings.map((sub, index) => createSubheadingBlock(sub, index)).join('');
            
            subheadings.forEach((sub, index) => {
                innerEditors[index] = new EditorJS({
                    holder: `editor-${index}`,
                    tools: {
                        header: { class: Header, inlineToolbar: true },
                        paragraph: { class: Paragraph, inlineToolbar: true },
                        table: Table,
                        quote: { class: Quote, inlineToolbar: true },
                        inlineCode: InlineCode,
                        underline: Underline,
                        link: { class: LinkTool, config: { endpoint: "https://your-backend.com/fetchUrl" } },
                        image: {
                            class: ImageTool,
                            config: {
                                endpoints: {
                                    byFile: "https://your-backend.com/uploadFile",
                                    byUrl: "https://your-backend.com/fetchUrl"
                                }
                            }
                        },
                        code: CodeTool
                    },
                    data: sub.content ? { blocks: JSON.parse(sub.content).blocks } : getDefaultContent(sub.title)
                });
            });
        }

        function addSubheading(afterIndex) {
            let newTitle = prompt("Enter subheading name:");
            if (!newTitle) return;
            let newNumber = Math.max(...subheadings.map(s => s.number)) + 1;
            subheadings.splice(afterIndex + 1, 0, { title: newTitle, number: newNumber });
            saveSubheadings();
            renderSubheadings();
        }

        function removeSubheading(index) {
            if (confirm("Are you sure?")) {
                subheadings.splice(index, 1);
                saveSubheadings();
                renderSubheadings();
            }
        }

        function clearEditor(index) {
            innerEditors[index].clear();
        }

        function clearAllData() {
            if (confirm("Clear all data? This will reset everything to default.")) {
                localStorage.setItem('subheadings', JSON.stringify(defaultSubheadings));
                subheadings = [...defaultSubheadings];
                renderSubheadings();
            }
        }

        function saveSubheadings() {
            localStorage.setItem('subheadings', JSON.stringify(subheadings));
        }

        renderSubheadings();
    </script>
</body>
</html>
